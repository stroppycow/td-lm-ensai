---
title: "TD 2 - Exercice 3"
lang: fr
author: "Th√©o Leroy"
date: "26 septembre 2025"
params:
  question_courante: 10
format:
  live-html:
    code-background: true
    toc: true
    page-layout: full
webr:
  render-df: gt-interactive
  resources:
    - ./../data/icecream-R.dat
  packages:
      - tidyverse
      - car
      - GGally
      - rgl
fig-align: center
filters: 
  - diagram
  - custom-callout
editor: 
  mode: source
  markdown: 
    wrap: 72
custom-callout:    
  answer:
    color: "#CCCCCC"
    icon: true
    icon-symbol: "üìù"
    appearance: "default"
    title: "Correction"
---

![](/static/img/icecream.jpg){fig-align="center"}

{{< include ./../_extensions/conditionnal.qmd >}}
{{< include ./../_extensions/r-wasm/live/_knitr.qmd >}}

On √©tudie la consommation de glaces aux Etats-Unis sur une p√©riode de 30
semaines du 18 Mars 1950 au 11 Juillet 1953. Les variables sont la
p√©riode (de la semaine 1 √† la semaine 30), et en moyenne sur chaque
p√©riode : la consommation de glaces par personne ($\texttt{Consumption}$, en 1/2
litre), le prix des glaces ($\texttt{Price}$, en dollars), le salaire
hebdomadaire moyen par m√©nage ($\texttt{Income}$, en dollars), et la temp√©rature
($\texttt{Temp}$, en degr√© Fahrenheit). Les donn√©es sont disponibles dans le
fichier `icecream-R.dat`.

## Question 1

Extraire les donn√©es et repr√©senter la consommation en fonction des
diff√©rentes variables.

::: {.content-visible when-meta="is_answer_print_1"}

::: answer

On charge les donn√©es du fichier `icecream-R.dat` en {{< iconify logos:r-lang >}} sous forme de
`data.frame`.

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
data_icecream <- read.csv(
  file = "data/icecream-R.dat",
  header = TRUE,
  sep = "" # signifie un espace ou plus ou une tabulation
)
data_icecream
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
data_icecream <- readr::read_delim(
  file = "data/icecream-R.dat",
  col_types = "innii",
  col_names = c("Period", "Consumption", "Price", "Income", "Temp"),
  skip = 1,
  delim = "\t"
)
data_icecream
```
:::

Le fichier charg√© contient bien 30 observations avec les variables :

-   $\texttt{Period}$ pour la p√©riode (de la semaine 1 √† la semaine 30)
-   $\texttt{Consumption}$ pour la consommation moyenne de glaces par personne en
    1/2 litre (c'est la variable √† expliquer)
-   $\texttt{Price}$ pour le prix moyen des glaces en dollars
-   $\texttt{Income}$ pour le salaire hebdomadaire moyen par m√©nage
-   $\texttt{Temp}$ pour la temp√©rature moyenne en degr√© Fahrenheit

On repr√©sente ces donn√©es dans des nuages de points.

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
pairs(
  x = data_icecream[,-1],
  main = "Matrice des nuages de points sur les donn√©es de consommation de glaces"
)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
GGally::ggpairs(
    data = data_icecream,
    columns  = c("Consumption", "Price", "Income", "Temp"),
    title = "Matrice des nuages de points sur les donn√©es de consommation de glaces",
    upper = list(continuous = "cor")
)
```
:::

Tracer tous les nuages de points 2 √† 2 et pas seulement les nuages de
points avec la variable d‚Äôint√©r√™t peut permettre de d√©tecter des
probl√®mes de colin√©arit√©. On note que ce potentiel ph√©nom√®ne n'est pas
pr√©sent ici.

Un lien lin√©aire semble exister ici entre la consommation de glaces et
la temp√©rature, ce qui para√Æt assez naturel, mais il n'y a pas de
relation √©vidente avec les autres variables. De plus, il n'y a pas de
raison convaincante d'explorer une relation non-lin√©aire (carr√©, racine,
logarithme...).
:::

:::

## Question 2

On propose de r√©gresser lin√©airement la consommation sur les trois
variables $\texttt{Price}$, $\texttt{Income}$ et $\texttt{Temp}$, en supposant de plus qu‚Äôune
constante est pr√©sente dans le mod√®le. On note la constante $\beta_1$ et
les trois coefficients associ√©s aux variables pr√©c√©dentes respectivement
$\beta_2$, $\beta_3$ et $\beta_4$. R√©aliser la phase d‚Äôestimation de
cette r√©gression et commenter le signe des coefficients estim√©s.

::: {.content-visible when-meta="is_answer_print_2"}

::: answer
On effectue la r√©gression
$\texttt{Consumption}_i = \beta_1+\beta_2\texttt{Price}_i+\beta_3\texttt{Income}_i+\beta_4\texttt{Temp}_i+\varepsilon_i$
√† l'aide de la fonction `lm` disponible nativement dans
{{< iconify logos:r-lang >}}. On cherche ainsi une estimation de
$\beta_1$, $\beta_2$, $\beta_3$ et $\beta_4$ √† l'aide de la m√©thode des
moindres carr√©s ordinaires (MCO).

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
fit_lm_icecream <- lm(Consumption ~ Price + Income + Temp, data = data_icecream) 
summary(fit_lm_icecream)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
fit_lm_icecream <- lm(Consumption ~ Price + Income + Temp, data = data_icecream) 
summary(fit_lm_icecream)
```
:::

La premi√®re colonne de la partie not√©e <tt>Coefficients</tt> de la
sortie `summary` donne la valeur des coefficients estim√©s.

Sans regarder les valeurs, on peut d'abord observer les signes des
estimations comme le propose l'√©nonc√©. La consommation semble d√©cro√Ætre
avec l'augmentation du prix (signe n√©gatif pour
$\widehat{\beta}_2 < 0$), augmenter avec les revenus des m√©nages (signe
positif $\widehat{\beta}_3 > 0$) et avec la temp√©rature (signe positif
$\widehat{\beta}_4 > 0$).

N√©anmoins, le coefficient $\widehat{\beta}_2$ n'est pas
significativement diff√©rent de 0 donc l'effet du prix sur la
consommation n'est donc pas confirm√©. On ne devrait pas le commenter
(cf. question 4).
:::

:::

## Question 3

Tester la significativit√© globale du mod√®le propos√©, i.e.
$H_0 \ : \ \beta_2=\beta_3=\beta_4=0$ √† l‚Äôaide du test de Fisher global.

::: {.content-visible when-meta="is_answer_print_3"}

::: answer
On teste $H_0: \ \beta_2 = \beta_3 = \beta_4 = 0$ contre
$H_1: \ \beta_2 \neq 0 \ \textrm{ou} \ \beta_3 \neq 0 \ \textrm{ou} \ \beta_4 \neq 0$
√† l'aide d'un test de Fisher global. La derni√®re ligne de la sortie du
`summary` rend compte de ce test.

La p-value est bien inf√©rieure √† $0,05$ donc on rejette $H_0$. Ainsi, au
moins un coefficient (autre que la constante) est significatif.
:::

:::

## Question 4

Tester la significativit√© de la variable $\texttt{Price}$ dans ce mod√®le au seuil
de 5 %. Tester de m√™me la significativit√© de $\texttt{Income}$, puis de $\texttt{Temp}$.

::: {.content-visible when-meta="is_answer_print_4"}

::: answer
On applique un test de Student de significativit√© √† chaque coefficient
associ√©. C‚Äôest le test propos√© dans la sortie
{{< iconify logos:r-lang >}} (troisi√®me et quatri√®me colonne). A la
lecture des p-values par exemple, au seuil de 5 %, les variables
$\texttt{Income}$ et $\texttt{Temp}$ sont significatives (les p-values sont
inf√©rieures √† 0,05).
:::

:::


## Question 5

Comparer le mod√®le complet pr√©c√©dent et le mod√®le sans la variable
$\texttt{Price}$ √† l‚Äôaide d‚Äôun test de Fisher :

1.  En basant le calcul sur la somme des carr√©s r√©siduelle de chaque
    mod√®le ;
2.  En basant le calcul sur le coefficient de d√©termination de chaque
    mod√®le ;
3.  En utilisant la fonction `linearHypothesis` de la librairie `car` ;
4.  En utilisant la fonction anova.

Quel est la diff√©rence entre ce test et le test de Student de
significativit√© de la variable $\texttt{Price}$ ?

::: {.content-visible when-meta="is_answer_print_5"}

::: answer
On estime un mod√®le sans la variable $\texttt{Price}$.

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
fit_lm_icecream_without_price <- lm(Consumption ~ Income + Temp, data = data_icecream) 
summary(fit_lm_icecream_without_price)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
fit_lm_icecream_without_price <- lm(Consumption ~ Income + Temp, data = data_icecream) 
summary(fit_lm_icecream_without_price)
```
:::

**Test de Fisher en basant le calcul sur la somme des carr√©s r√©siduelle
de chaque mod√®le**

La statistique du test de Fisher vaut :

$$
F=\frac{n-p}{q} \frac{SCR_c-SCR}{SCR}
$$

-   $n=30$ car il y a 30 observations
-   $p=4$ car il y a param√®tres dans le mod√®le complet (trois variables
    plus la constante)
-   $q=1$ car il y a une seule contrainte dans le mod√®le contraint (le
    coefficient associ√© au prix est nul $\beta_{2}=0$)
-   $SCR$ est la somme des carr√©s des r√©sidus $\widehat{\varepsilon}_i$
    dans le mod√®le complet et $SCR_c$ dans l'√©quivalent dans le mod√®le
    contraint

On compare cette statistique au quantile $0,95$ d'une loi de Fisher
$(q, \ n-p)$.

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
F1 <- (nrow(data_icecream) - 4L)/1*(
  sum(fit_lm_icecream_without_price$residuals**2)/sum(fit_lm_icecream$residuals**2)-1)
F1
qf(p = 0.95, df1 = 1, df2 = nrow(data_icecream) - 4)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
F1 <- (nrow(data_icecream) - 4L)/1*(
  sum(fit_lm_icecream_without_price$residuals**2)/sum(fit_lm_icecream$residuals**2)-1)
F1
qf(p = 0.95, df1 = 1, df2 = nrow(data_icecream) - 4)
```
:::

On ne rejette pas $H_0$ car $F \leq q_{0,95}^{\mathcal{F}(q, \ n-p)}$
ainsi $\beta_2$ n'est pas significatif au seuil $5\ \%$.

**Test de Fisher en basant le calcul sur le coefficient de d√©termination
de chaque mod√®le**

On utilise la formule de $F$ faisant intervenir le $R^2$ d√©termin√©e √†
l'exercice pr√©c√©dent.

$$
F=\frac{R^2-R_c^2}{1-R^2} \frac{n-p}{q}
$$

On rel√®ve dans les sorties des deux mod√®les : $R^2=0,719$ et
$R_c^2=0,7021$, ce qui se fait de fa√ßon automatique par

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
F2 <- (nrow(data_icecream) - 4L)/1*(
  summary(fit_lm_icecream)$r.squared -
  summary(fit_lm_icecream_without_price)$r.squared
)/(
  1 - summary(fit_lm_icecream)$r.squared
)
F2
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
F2 <- (nrow(data_icecream) - 4L)/1*(
  summary(fit_lm_icecream)$r.squared -
  summary(fit_lm_icecream_without_price)$r.squared
)/(
  1 - summary(fit_lm_icecream)$r.squared
)
F2
```
:::

**Test de Fisher en utilisant la fonction `linearHypothesis` de la
librairie `car`**

On renseigne la matrice de contrainte $R$ que l'on souhaite dans le test
$H_0: R \beta=0$. Il s'agit d'une matrice de taille $(q, p)$. Ici, on
souhaite simplement tester si $\beta_{2}=0$ c'est √† dire si le deuxi√®me
coefficient du vecteur $\beta$ est nul. La matrice $R$ est donc un
vecteur ligne valant $R=(0,1,0,0)$.

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
car::linearHypothesis(fit_lm_icecream, c(0,1,0,0))
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
car::linearHypothesis(fit_lm_icecream, c(0,1,0,0))
```
:::

On ne rejette pas $H_0$ car la p-value est sup√©rieure √† $0,05$.

**Test de Fisher en utilisant la fonction `anova`**

De la m√™me mani√®re, la fonction `anova` permet de comparer deux mod√®les
emboit√©s.

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
anova(fit_lm_icecream, fit_lm_icecream_without_price)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
anova(fit_lm_icecream, fit_lm_icecream_without_price)
```
:::

La significativit√© d‚Äôun seul coefficient est √©quivalent au test de
Student associ√©, on a d'ailleurs $T_2^2=F$.
:::

:::

## Question 6

Comparer le mod√®le complet et le mod√®le sans la variable $\texttt{Price}$ et sans
la constante √† l‚Äôaide d‚Äôun test de Fisher. Proc√©der selon les 4 mani√®res
d√©crites ci-dessus.

Commenter.

::: {.content-visible when-meta="is_answer_print_6"}

::: answer
On estime un mod√®le sans la variable $\texttt{Price}$ et la constante. On
teste

$$H_0: \ \beta_1 = \beta_2  = 0 \textrm{ contre } H_1: \ \beta_1 \neq 0 \ \textrm{ou} \ \beta_2 \neq 0$$

On a $q=2$ d√©sormais.

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
fit_lm_icecream_without_price_and_intercept <- lm(
  Consumption ~ Income + Temp -1L,
  data = data_icecream
) 
summary(fit_lm_icecream_without_price_and_intercept)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
fit_lm_icecream_without_price_and_intercept <- lm(
  Consumption ~ Income + Temp -1L,
  data = data_icecream
) 
summary(fit_lm_icecream_without_price_and_intercept)
```
:::

**Test de Fisher en basant le calcul sur la somme des carr√©s r√©siduelle
de chaque mod√®le**

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
F1 <- (nrow(data_icecream) - 4L)/2*(
  sum(fit_lm_icecream_without_price_and_intercept$residuals**2)
  /
  sum(fit_lm_icecream$residuals**2)-1
)
F1
qf(p = 0.95, df1 = 2, df2 = nrow(data_icecream) - 4)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
F1 <- (nrow(data_icecream) - 4L)/2*(
  sum(fit_lm_icecream_without_price_and_intercept$residuals**2)
  /
  sum(fit_lm_icecream$residuals**2)-1
)
F1
qf(p = 0.95, df1 = 2, df2 = nrow(data_icecream) - 4)
```
:::

On ne rejette pas $H_0$ car $F \leq q_{0,95}^{\mathcal{F}(q, \ n-p)}$
ainsi $\beta_1$ et $\beta_2$ ne sont pas significatifs au seuil $5\ \%$.

**Test de Fisher en basant le calcul sur le coefficient de d√©termination
de chaque mod√®le**

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
F2 <- (nrow(data_icecream) - 4L)/2*(
  summary(fit_lm_icecream)$r.squared -
    summary(fit_lm_icecream_without_price_and_intercept)$r.squared
)/(
  1 - summary(fit_lm_icecream)$r.squared
)
F2
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
F2 <- (nrow(data_icecream) - 4L)/2*(
  summary(fit_lm_icecream)$r.squared -
    summary(fit_lm_icecream_without_price_and_intercept)$r.squared
)/(
  1 - summary(fit_lm_icecream)$r.squared
)
F2
```
:::

La valeur de $F$ obtenue n'est pas la m√™me. Celle-ci n'est pas bonne car
la formule utilis√©e n‚Äôest pas valable : l‚Äôexpression avec le $R^2$ n‚Äôest
bonne que si la constante est pr√©sente dans les deux mod√®les (le
contraint et le non contraint), ce qui n‚Äôest pas le cas ici.

**Test de Fisher en utilisant la fonction `linearHypothesis` de la
librairie `car`**

La matrice $R$ vaut d√©sormais

$$
  R=\begin{pmatrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
\end{pmatrix}
$$

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
car::linearHypothesis(
  fit_lm_icecream,
  matrix(c(1, 0, 0, 0, 0, 1, 0, 0), nrow = 2, byrow = TRUE)
)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
car::linearHypothesis(
  fit_lm_icecream,
  matrix(c(1, 0, 0, 0, 0, 1, 0, 0), nrow = 2, byrow = TRUE)
)
```
:::

On ne rejette pas $H_0$ car la p-value est sup√©rieure √† $0,05$.

**Test de Fisher en utilisant la fonction `anova`**

De la m√™me mani√®re, la fonction `anova` permet de comparer deux mod√®les
emboit√©s.

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
anova(
  fit_lm_icecream,
  fit_lm_icecream_without_price_and_intercept
)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
anova(
  fit_lm_icecream,
  fit_lm_icecream_without_price_and_intercept
)
```
:::

:::

:::

## Question 7

On d√©sire √† pr√©sent pr√©dire la consommation de glaces pour les donn√©es
suivantes : 

$$\texttt{Price} = 0.3, \quad \texttt{Income} = 85 \quad \textrm{et}  \quad \texttt{Temp} = 65$$
 
Proposer la pr√©vision qui vous semble la meilleure au vu des mod√®les √©tudi√©s
pr√©c√©demment. Donner un intervalle de pr√©vision au niveau 95 % autour de
cette pr√©vision.

::: {.content-visible when-meta="is_answer_print_7"}

::: answer
D'apr√®s la question pr√©c√©dente, le mod√®le sans la constante et le
coefficient associ√© √† la variable prix semble meilleur (car significatif
et plus parcimonieux)

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
newdata <- data.frame(Income = 85,Temp = 65)
predict(
  object = fit_lm_icecream_without_price_and_intercept,
  newdata = newdata,
  interval = "prediction"
)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
newdata <- data.frame(Income = 85,Temp = 65)
predict(
  object = fit_lm_icecream_without_price_and_intercept,
  newdata = newdata,
  interval = "prediction"
)
```
:::

On pr√©dit une consommation de $0,41$ avec $IC = [0,33; \ 0,49]$ √†
$95\ \%$.
:::

:::

## Question 8

Sous quelle hypoth√®se l‚Äôintervalle de pr√©vision pr√©c√©dent est-il valable
? V√©rifier-la en observant le QQ-plot des r√©sidus de la r√©gression et en
effectuant un test statistique.

::: {.content-visible when-meta="is_answer_print_8"}

::: answer
L'intervalle de pr√©vision est valable uniquement sous hypoth√®se
gaussienne.

On peut examiner cette hypoth√®se avec un QQ-plot ou avec le test de
Shapiro-Wilk. L'hypoth√®se nulle de ce test est l'√©chantillon suit une loi normale.

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
qqnorm(fit_lm_icecream_without_price_and_intercept$residuals)
shapiro.test(fit_lm_icecream_without_price_and_intercept$residuals)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
qqnorm(fit_lm_icecream_without_price_and_intercept$residuals)
shapiro.test(fit_lm_icecream_without_price_and_intercept$residuals)
```
:::

M√™me si le diagramme quantile-quantile n'est pas tr√®s convaincant, le
test de Shapiro-Wilk ne permet pas de rejeter l‚Äôhypoth√®se nulle de
Gaussianit√© des r√©sidus.
:::

:::

## Question 9

V√©rifier les autres hypoth√®ses en rappelant la d√©finition et en
calculant les VIF ("Variance Inflation Factor") de chaque variable
explicative et en effectuant une analyse graphique des r√©sidus.

::: {.content-visible when-meta="is_answer_print_9"}

::: answer
**Analyse de l'absence de multicolin√©arit√©**

Le VIF pour la variable $X^{(j)}$ vaut 

$$
VIF_j=\frac{1}{1-R_j^2}
$$

o√π $R_j^2$ est le $R^2$ dans la r√©gression de $X^{(j)}$ par rapport
aux autres variables explicatives. $R_j^2$ peut √™tre vu comme la mesure
de la corr√©lation entre $X^{(j)}$ est les autres variables, de telle
sorte que $VIF_j$ explose si $R_j^2$ est proche de 1 , c'est √† dire s'il
y a un probl√®me de multicolin√©arit√© entre la variable $X^{(j)}$ et les
autres variables. On a toujours $VIF_j \geq 1$ et on consid√®re qu'il y a
un probl√®me de multicolin√©arit√© lorsque $VIF_j>5$ (ce seuil n'est pas
strict, c'est juste un seuil d'alerte).

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
car::vif(fit_lm_icecream)
car::vif(fit_lm_icecream_without_price)
car::vif(fit_lm_icecream_without_price_and_intercept)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
car::vif(fit_lm_icecream)
car::vif(fit_lm_icecream_without_price)
car::vif(fit_lm_icecream_without_price_and_intercept)
```
:::

On constate que les VIF dans le mod√®le global ne sont pas √©lev√©s (le
plus grand √©tant de 1,14), ce qui indique l'absence de colin√©arit√© entre
les variables explicatives. Cette observation est coh√©rente avec les
nuages de points analys√©s au d√©but de l'exercice, qui ne montraient pas
de relations fortes entre ces variables.

Cette conclusion est √©galement confirm√©e par le calcul des VIF pour le
sous-mod√®le `fit_lm_icecream_without_price`, car si aucune colin√©arit√©
n'existe dans un mod√®le, elle ne peut pas appara√Ætre dans un
sous-mod√®le.

En revanche, le r√©sultat est diff√©rent pour le sous-mod√®le
`fit_lm_icecream_without_price_and_intercept`, car celui-ci ne comporte
pas de constante. Par cons√©quent, les $R_j^2$ utilis√©s dans le calcul
des $VIF_j$ ne se basent pas sur la formule habituelle du $R^2$, mais
sur une version sans constante, qui est diff√©rente. En particulier, le
$R^2$ sans constante est souvent beaucoup plus √©lev√© que le $R^2$ avec
constante (voir exercice 4), ce qui explique l'augmentation
significative des VIF dans ce cas. Un avertissement dans {{< iconify logos:r-lang >}} signale ce
probl√®me. En conclusion, il ne faut pas calculer les VIF dans un mod√®le
sans constante. L'analyse r√©alis√©e sur le mod√®le global (ainsi que sur
le sous-mod√®le `fit_lm_icecream_without_price`) garantit qu'il n'y a pas
de probl√®me de colin√©arit√© entre les variables explicatives.

**Analyse des r√©sidus**

::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
par(mfrow= c(2, 2))
plot(fit_lm_icecream_without_price_and_intercept)
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
par(mfrow= c(2, 2))
plot(fit_lm_icecream_without_price_and_intercept)
```
:::

On peut r√©aliser une analyse graphique rapide des r√©sidus en utilisant
la fonction plot sur le mod√®le estim√©. Quatre graphiques sont g√©n√©r√©s.
Le premier montre la r√©partition des r√©sidus en fonction des valeurs
ajust√©es $\widehat{y}_i$ : les r√©sidus sont ici distribu√©s de mani√®re
al√©atoire, sans structure apparente, ce qui est attendu pour des r√©sidus
"corrects". Le deuxi√®me graphique est le QQ-plot des r√©sidus, que nous
avons d√©j√† r√©alis√©. Le troisi√®me graphique est similaire au premier et
n'apporte g√©n√©ralement pas beaucoup d'informations suppl√©mentaires.
Enfin, le quatri√®me graphique permet d'identifier des individus
aberrants ou trop influents pour l'estimation : s'il n'y a pas de points
isol√©s (ce qui est le cas ici), il n'y a pas de probl√®me particulier.
Dans ce dernier graphique, on voit des pointill√©s en haut √† droite,
correspondant √† la ligne de niveau de la distance de Cook, qui a une
forme d'hyperbole. Si un point se trouve au-del√† de ces pointill√©s, cela
indiquerait qu'il est influent et/ou aberrant, mais ce n'est pas le cas
ici.
:::

:::

## Question 10

Observer le nuage de points en 3D des variables $\texttt{Consumption}$, $\texttt{Income}$
et $\texttt{Temp}$, et l‚Äôajustement par le mod√®le lin√©aire, √† l‚Äôaide de
`scatter3d` de la librairie `car`.

::: {.content-visible when-meta="is_answer_print_10"}

::: answer
::: {.panel-tabset group="language"}
### Base R

```{webr}
#| envir: baser
#| autorun: true
car::scatter3d(
  data_icecream$Income,
  data_icecream$Consumption,
  data_icecream$Temp,
  xlab = "Income",
  ylab = "Consumption",
  zlab = "Temp"
)
rgl::rglwidget()
```

### Tidyverse

```{webr}
#| envir: tdv
#| autorun: true
car::scatter3d(
  data_icecream$Income,
  data_icecream$Consumption,
  data_icecream$Temp,
  xlab = "Income",
  ylab = "Consumption",
  zlab = "Temp"
)
rgl::rglwidget()
```
:::

:::

:::
