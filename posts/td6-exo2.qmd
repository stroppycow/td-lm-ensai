---
title: "TD 6 - Exercice 2 - Le mod√®le logistique est naturel"
lang: fr
author: "Th√©o Leroy"
date: "14 novembre 2025"
params:
  question_courante: 0
format:
  live-html:
    code-background: true
    toc: true
    page-layout: full
editor: 
  mode: source
  markdown: 
    wrap: 72
fig-align: center
filters: 
  - custom-callout
custom-callout:    
  answer:
    color: "#CCCCCC"
    icon: true
    icon-symbol: "üìù"
    appearance: "default"
    title: "Correction"
---

{{< include ./../_extensions/conditionnal.qmd >}}
{{< include ./../_extensions/r-wasm/live/_knitr.qmd >}}


On dispose d‚Äôun couple de variables al√©atoires $(X,Y)$ 
o√π $Y$ est binaire et $X$ est √† valeurs dans $\mathbb{R}^d$. 
On note $p = \mathbb{P}(Y = 1)$, $f_0(\cdot)$ la densit√© conditionnelle de $X$ sachant que $Y = 0$ et $f_1(\cdot)$ la densit√© conditionnelle de $X$
sachant que $Y = 1$. On note de plus

$$
h(x)=\log\left(\frac{f_1(x)}{f_0(x)}\right)+\log\left(\frac{p}{1-p}\right) \ , \quad x\in \mathbb{R}^d
$$


## Question 1

Montrer que pour tout $x \in \mathbb{R}^d$

::: {.content-visible when-meta="is_answer_print_1"}

::: answer

En notant, $p =  \mathbb{P}(Y = 1)$, $f_0(\cdot)$ la densit√© conditionnelle de $X$
sachant que $Y = 0$ et $f_1(.)$ la densit√© conditionnelle de $X$ sachant
que $Y = 1$.

D'apr√®s la formule de Bayes,

$$
\begin{aligned}
\mathbb{P}(Y=1 \mid X = x) &= 
\frac{f_1(x) p}{f_1(x) p+f_0(x)(1-p)} \\
& =\frac{1}{1+\frac{f_0(x)(1-p)}{f_1(x) p}} \\
& =\frac{1}{1+\exp \left(\log \left(\frac{f_0(x)(1-p)}{f_1(x) p}\right)\right)} \\
& =\frac{1}{1+\exp \left(\log \left(\frac{f_0(x)}{f_1(x)}\right)+\log \left(\frac{p}{1-p}\right)\right)} \\
& =\frac{1}{1+e^{-h(x)}} \textrm{ car } h(x) = \log\left(\frac{f_1(x)}{f_2(x)}\right)+\log\left(\frac{p}{1-p}\right).
\end{aligned}
$$

:::

:::

## Question 2

On rappelle qu‚Äôune loi sur Rd fait partie de la famille exponentielle si sa densit√©
s‚Äô√©crit $a(x)b(x)e^{\theta^{'}T(x)}$, pour un certain param√®tre 
$\theta \in \mathbb{R}^q$, o√π $a$ et $b$ sont des fonctions positives 
et $T : \mathbb{R}^d \longrightarrow \mathbb{R}^q$ est une fonction 
appel√©e statistique suffisante.

Montrer que si les densit√©s conditionnelles $f_0$ et $f_1$ font partie de la m√™me famille
exponentielle et ne diff√®rent que par la valeur de leur param√®tre associ√©, alors
$\mathbb{P}(Y = 1|X = x)$ suit exactement un mod√®le de r√©gression logistique,
dont on pr√©cisera le param√®tre et les variables.

::: {.content-visible when-meta="is_answer_print_2"}

::: answer

D'apr√®s l'√©nonc√©
$$f_0(x)=a(x) b\left(\theta_0\right) e^{\theta_0 \cdot T(x)} \textrm{ et }
f_1(x)=a(x) b\left(\theta_1\right) e^{\theta_1 \cdot T(x)}$$

pour deux param√®tres $\theta_0$ et $\theta_1$ distincts.

La fonction $h$ de la question pr√©c√©dente s'√©crit donc :

$$
\begin{align*}
h(x)&=\log\left(\frac{a(x) b\left(\theta_1\right) e^{\theta_1 \cdot T(x)}p}{a(x) b\left(\theta_0\right) e^{\theta_0 \cdot T(x)}(1-p)}\right) \\
&= \log\left(\frac{b\left(\theta_1\right)p}{b\left(\theta_0\right)(1-p)} \right)+(\theta_1-\theta_0)T(x) \\
&= \beta'\tilde{T}(x)
\end{align*}
$$

o√π
$\beta=\left(\log \frac{b\left(\theta_1\right) p}{b\left(\theta_0\right)(1-p)}, \theta_1-\theta_0\right)$
est un vecteur de taille $q+1$ et $\tilde{T}(x)=(1, T(x))$.

On a donc d'apr√®s la question pr√©c√©dente

$$
\mathbb{P}(Y=1 \mid X=x)=\frac{1}{1+e^{-\beta^{\prime} \cdot \tilde{T}(x)}},
$$

qui est bien un mod√®le logistique associ√© aux variables $\tilde{T}(x)$
et au param√®tre $\beta$.

:::

:::
