---
title: "TD 2 - Exercice 8 - Comparaison des crit√®res de s√©lection d'un mod√®le"
lang: fr
author: "Th√©o Leroy"
date: "17 octobre 2025"
params:
  question_courante: 6
format:
  live-html:
    code-background: true
    toc: true
    page-layout: full
editor: 
  mode: source
  markdown: 
    wrap: 72
fig-align: center
filters: 
  - diagram
  - custom-callout
custom-callout:    
  answer:
    color: "#CCCCCC"
    icon: true
    icon-symbol: "üìù"
    appearance: "default"
    title: "Correction"
---

{{< include ./../_extensions/conditionnal.qmd >}}
{{< include ./../_extensions/r-wasm/live/_knitr.qmd >}}

On consid√®re un mod√®le de r√©gression lin√©aire visant √† expliquer $Y$ en fonction des variables
$X^{(1)}, \dots, X^{(p)}$. On d√©sire choisir entre le mod√®le avec $X^{(p)}$ et le mod√®le sans $X^{(p)}$ (les autres
variables √©tant incluses dans les deux cas), sur la base d‚Äôun √©chantillon de $n$ individus.

On not $F$ la statistique :

$$
F=(n-p)\frac{\textrm{SCR}_c-\textrm{SCR}}{\textrm{SCR}}
$$

o√π $\textrm{SCR}$ d√©signe la somme des carr√©s r√©siduelle dans le mod√®le avec $\textrm{X}^{(p)}$, et $\textrm{SCR}_c$ d√©signe
la somme des carr√©s r√©siduelle dans le mod√®le sans $\textrm{X}^{(p)}$.

## Question 1

En appliquant un test de Fisher de mod√®les emboit√©s, selon quelle r√®gle de d√©cision,
bas√©e sur $F$, choisira-t-on d‚Äôinclure la variable $\textrm{X}^{(p)}$ dans le mod√®le ?


::: {.content-visible when-meta="is_answer_print_1"}

::: answer

Dans le mod√®le

$$Y= \beta_1X^{(1)}+\dots+\beta_pX^{(p)}+\varepsilon \qquad \textrm{avec} \ \varepsilon \sim \mathcal{N}(0,\sigma^2I_n)$$

On teste $H_0 \ : \ \beta_p=0 \ vs \ H_1 \ : \beta_p \neq 0$

La variable $X^{(p)}$ est incluse si l'hypoth√®se $H_{1}$ est retenue,
c'est-√†-dire si $F > q_{1-\alpha}^{\mathcal{F}\left(1, \ n-p\right)}$,
o√π $q_{1-\alpha}^{\mathcal{F}\left(1, \ n-p\right)}$ repr√©sente le
quantile d'ordre $1-\alpha$ de la loi de Fisher $(1, n-p)$. Cette r√®gle
de d√©cision exige de fixer le niveau de test $\alpha$. On choisi souvent
par convention $\alpha=0.05$.

:::

:::

## Question 2

On rappelle que le $R^2$ ajust√© dans un mod√®le √† $k$ variables et $n$ individus est d√©fini
par

$$
R^2_a=1-\frac{n-1}{n-k}\frac{\textrm{SCR}_k}{\textrm{SCT}}
$$
o√π $\textrm{SCR}_k$ d√©signe la somme des carr√©s r√©siduelles dans le mod√®le, et $\textrm{SCT}$ la somme
des carr√©s totaux.

Montrer qu‚Äôon d√©cidera d‚Äôinclure $X^{(p)}$ selon le crit√®re du $R^2$ ajust√© si $F > 1$.

::: {.content-visible when-meta="is_answer_print_2"}

::: answer

On inclut $X^{(p)}$ si $R_{a}^{2}$ dans le mod√®le avec $X^{(p)}$ est
sup√©rieur au $R_{a}^{2}$ dans le mod√®le sans $X^{(p)}$, c'est √† dire si

$$
\underbrace{1-\frac{n-1}{n-p} \frac{\textrm{SCR}}{\textrm{SCT}}}_{R_a^{2} \textrm{ dans le mod√®le avec } X^{(p)}}>\underbrace{1-\frac{n-1}{n-(p-1)} \frac{\textrm{SCR}_{c}}{\textrm{SCT}}}_{R_a^{2} \textrm{ dans le mod√®le sans } X^{(p)}}
$$

o√π l'on note comme dans la question pr√©c√©dente $\textrm{SCR}$ la somme
des carr√©s r√©siduelle dans le mod√®le avec $X^{(p)}$, et
$\textrm{SCR}_{c}$ la somme des carr√©s r√©siduelle dans le mod√®le sans
$X^{(p)}$.

On simplifie l'in√©galit√© pr√©c√©dente :

$$
\begin{align*}
-\frac{n-1}{n-p} \frac{\textrm{SCR}}{\textrm{SCT}} & >-\frac{n-1}{n-(p-1)} \frac{\textrm{SCR}_{c}}{\textrm{SCT}} \\
\frac{\textrm{SCR}}{n-p} & < \frac{\textrm{SCR}_{c}}{n-(p-1)} \\
(n-p+1)\textrm{SCR} & <(n-p) \textrm{SCR}_{c} \\
(n-p) \textrm{SCR}+\textrm{SCR} & >(n-p) \textrm{SCR}_{c} \\
\textrm{SCR} & <(n-p)\left(\textrm{SCR}_{c}-\textrm{SCR}\right) \\
1 & <F
\end{align*}
$$

:::

:::

## Question 3

On rappelle que le $C_p$ de Mallows dans un mod√®le √† $k$ variables et $n$ individus est
d√©fini par 

$$
C_p=\frac{\textrm{SCR}_k}{\hat{\sigma}^2}-n+2k
$$

o√π $\textrm{SCR}_k$ d√©signe la somme des carr√©s r√©siduelles dans le mod√®le, et $\hat{\sigma}^2$ est un estimateur
de $\sigma^2$ bas√© sur le plus gros mod√®le possible. On prendra ici $\hat{\sigma}^2=\textrm{SCR}/(n-p)$,
o√π $\textrm{SCR}$ d√©signe la somme des carr√©s r√©siduelle dans le mod√®le avec $X^{(p)}$.

Montrer qu‚Äôon d√©cidera d‚Äôinclure $X^{(p)}$ selon le crit√®re du $C_p$ de Mallows si $F > 2$.

::: {.content-visible when-meta="is_answer_print_3"}

::: answer

On inclut $X^{(p)}$ si le $C_p$ dans le mod√®le avec $X^{(p)}$ est
inf√©rieur au $C_p$ dans le mod√®le sans $X^{(p)}$, c'est √† dire si

$$
\begin{align*}
\underbrace{\frac{\textrm{SCR}}{\hat{\sigma}^{2}}-n+2p}_{C_p \textrm{ dans le mod√®le avec } X^{(p)}} &< \underbrace{\frac{\textrm{SCR}_c}{\hat{\sigma}^{2}}-n+2(p-1)}_{C_p \textrm{ dans le mod√®le sans } X^{(p)}} \\
\frac{\textrm{SCR}}{\hat{\sigma}^{2}} &< \frac{\textrm{SCR}_c}{\hat{\sigma}^{2}}-2 \\
2 &< \frac{\textrm{SCR}_c-SRC}{\hat{\sigma}^{2}}
\end{align*} 
$$ Or $\hat{\sigma}^{2}=\frac{SCR}{n-p}$ donc $F>2$ .

:::

:::

## Question 4

On rappelle que le crit√®re AIC dans un mod√®le √† $k$ variables, √† $n$ individus, avec des
r√©sidus gaussiens, est d√©fini par

$$
AIC=n(1+\log(2\pi))+n\ \textrm{log}\left(\frac{\textrm{SCR}_k}{n} \right)+2(k+1)
$$

o√π $\textrm{SCR}_k$ d√©signe la somme des carr√©s r√©siduelles dans le mod√®le.

Montrer qu‚Äôon d√©cidera d‚Äôinclure $X^{(p)}$ selon le crit√®re AIC si $F > (n - p)(e^{2/n}- 1)$.

::: {.content-visible when-meta="is_answer_print_4"}

::: answer 

On inclut $X^{(p)}$ si l'AIC dans le mod√®le avec $X^{(p)}$ est inf√©rieur
√† l'AIC dans le mod√®le sans $X^{(p)}$, c'est √† dire si

$$
\begin{align*}
\underbrace{n(1+\log (2 \pi))+n \log\left(\frac{\textrm{SCR}}{n}\right)+2(p+1)}_{AIC \textrm{ dans le mod√®le avec } X^{(p)}} &< \underbrace{n(1+\log (2 \pi))+n \log\left(\frac{\textrm{SCR}_c}{n}\right)+2p}_{AIC \textrm{ dans le mod√®le sans } X^{(p)}} \\
n \log\left(\frac{\textrm{SCR}}{n}\right)+2 &< n \log\left(\frac{\textrm{SCR}_c}{n}\right) \\
2 &< n\log\left(\frac{\textrm{SCR}_c}{\textrm{SCR}}\right) \\
e^{\frac{2}{n}} &< \frac{\textrm{SCR}_c}{\textrm{SCR}} \\
(n-p)\left(e^{\frac{2}{n}} - 1\right) &< (n-p)\left(\frac{\textrm{SCR}_c}{\textrm{SCR}} - 1\right) \\
\end{align*} 
$$

Donc $F > (n-p)\left(e^{\frac{2}{n}} - 1\right)$

:::

:::

## Question 5

On rappelle que le crit√®re BIC (aussi parfois appel√© SBC) dans un mod√®le √† $k$
variables, √† $n$ individus, avec des r√©sidus gaussiens, est d√©fini par 

$$
BIC=n(1+\log(2\pi))+n\ \textrm{log}\left(\frac{\textrm{SCR}_k}{n} \right)+\log{(n)}(k+1)
$$
o√π $\textrm{SCR}_k$ d√©signe la somme des carr√©s r√©siduelles dans le mod√®le.

Montrer qu‚Äôon d√©cidera d‚Äôinclure $X^{(p)}$ selon le crit√®re BIC si $F > (n - p)(e^{\log{(n)}/n}- 1)$.

::: {.content-visible when-meta="is_answer_print_5"}

::: answer

On inclut $X^{(p)}$ si le BIC dans le mod√®le avec $X^{(p)}$ est
inf√©rieur au BIC dans le mod√®le sans $X^{(p)}$, c'est √† dire si

$$
\begin{align*}
\underbrace{n(1+\log (2 \pi))+n \log\left(\frac{\textrm{SCR}}{n}\right)+\log(n)(p+1)}_{BIC \textrm{ dans le mod√®le avec } X^{(p)}} &< \underbrace{n(1+\log (2 \pi))+n \log\left(\frac{\textrm{SCR}_c}{n}\right)+\log(n)p}_{BIC \textrm{ dans le mod√®le sans } X^{(p)}} \\
n \log\left(\frac{\textrm{SCR}}{n}\right)+\log(n) &< n \log\left(\frac{\textrm{SCR}_c}{n}\right) \\
\log(n) &< n\log\left(\frac{\textrm{SCR}_c}{\textrm{SCR}}\right) \\
e^{\frac{\log(n)}{n}} &< \frac{\textrm{SCR}_c}{\textrm{SCR}} \\
(n-p)\left(e^{\frac{\log(n)}{n}} - 1\right) &< (n-p)\left(\frac{\textrm{SCR}_c}{\textrm{SCR}} - 1\right) \\
\end{align*} 
$$

Donc $F > (n-p)\left(e^{\frac{\log(n)}{n}} - 1\right)$

:::

:::

## Question 6


En admettant que les quantiles √† 95 % d‚Äôune loi de Fisher de degr√© de libert√© $(1, \nu)$
prennent leurs valeurs dans l‚Äôintervalle $[3.8, 5]$ d√®s que $\nu > 10$, classer les crit√®res
pr√©c√©dents du plus conservatif (i.e. ayant tendance √† refuser plus facilement l‚Äôintroduction
de $X^{(p)}$) au moins conservatif (i.e. ayant tendance √† accepter plus facilement l‚Äôintroduction
de $X^{(p)}$). On pourra utiliser un d√©veloppement limit√© pour l‚Äô√©tude des crit√®res AIC
et BIC, en supposant que $n$ est suffisamment grand.

::: {.content-visible when-meta="is_answer_print_6"}

::: answer

Pour le crit√®re AIC, on a vu que l'on inclut $X^{(p)}$ si
$F>(n-p)\left(e^{2 / n}-1\right)$. Or, lorsque
$n \rightarrow \infty,\left(e^{2 / n}-1\right) \sim 2 / n$, de telle
sorte que le seuil est √©quivalent √† 2 . Ainsi lorsque $n$ est grand, le
crit√®re AIC devient similaire au crit√®re du $C_{p}$ de Mallows.

Pour le crit√®re BIC, le seuil est $(n-p)\left(e^{\log n / n}-1\right)$,
or $\left(e^{\log n / n}-1\right) \sim \log n / n$ et le seuil est
√©quivalent √† $\log n$. Selon BIC (et si $n$ est grand) on inclut donc
$X^{(p)}$ si $F>\log n$.

Pour les crit√®res consid√©r√©s, on a d'autant plus de facilit√© √† inclure
$X^{(p)}$ que le seuil $s$ dans la r√®gle $F>s$ est faible. Etant donn√©
les seuils calcul√©s pr√©c√©demment, les crit√®res se classent donc ainsi,
du plus conservatif (tendance √† rejeter plus facilement $X^{(p)}$ ), au
moins conservatif (tendance √† l'accepter) :

$$
\textrm{BIC} \leq \text { test } F \leq C_{p} \approx \textrm{AIC} \leq R_{a}^{2}
$$

d√®s que $\log n > 5$. Cette hi√©rarchie peut aussi s‚Äôinterpr√©ter en
fonction de la tendance √† conserver des mod√®les plus complexes : le
crit√®re $R_{a}^{2}$ privil√©gie g√©n√©ralement les mod√®les les plus
complets, tandis que le BIC favorise des mod√®les plus parcimonieux. Ces
crit√®res peuvent √™tre tous d'accord sur le fait qu'il est pr√©f√©rable
d'inclure ou non $X^{(p)}$, mais si jamais ils divergent, c'est dans le
sens des in√©galit√©s pr√©c√©dentes.

:::

:::
