---
title: "TD 2 - Exercice 4 - Le coefficient de corr√©lation multiple avec ou sans constante"
lang: fr
author: "Th√©o Leroy"
date: "26 septembre 2025"
params:
  question_courante: 0
format:
  live-html:
    code-background: true
    toc: true
    page-layout: full
filters: 
  - diagram
  - custom-callout
editor: 
  mode: source
  markdown: 
    wrap: 72
custom-callout:    
  answer:
    color: "#CCCCCC"
    icon: true
    icon-symbol: "üìù"
    appearance: "default"
    title: "Correction"
---

{{< include ./../_extensions/conditionnal.qmd >}}
{{< include ./../_extensions/r-wasm/live/_knitr.qmd >}}

On consid√®re le mod√®le de r√©gression

$$y_i=\beta_0+\beta_1x_i^{(1)}+\dots +\beta_px_i^{(p)} = \epsilon_i, \quad i = 1, \dots, n \quad (*) $$

o√π les variables $\epsilon_i$ sont centr√©es, de variance $\sigma^2$ et
non-corr√©l√©es. On pose $Y=(y_1, \dots, y_n)^T$,
$X^{(k)}=(x_1, \dots, x_n)^T$ et $\mathbb{1}=(1, \dots, 1)^{T}$. On
suppose que les variables $X^{(k)}$ ne sont pas lin√©airement li√©es √†
$\mathbb{1}$. On note $\overline{y}$ la moyenne empirique de $Y$ et
$\widehat{Y}=\hat{\beta}_0\mathbb{1}+\hat{\beta}_1X^{(1)}+\dots+\hat{\beta}_pX^{(p)}$
o√π les estimateurs sont ceux obtenus par les moindres carr√©s ordinaires.

## Question 1

Que repr√©sente g√©om√©triquement $\hat{Y}$ ? Repr√©senter sur un sch√©ma les
vecteurs $Y$, $\widehat{Y}$, $\overline{y}\mathbb{1}$,
$Y-\overline{y}\mathbb{1}$, $\widehat{Y}-\overline{y}\mathbb{1}$ et
$\hat{\epsilon}$.

::: {.content-visible when-meta="is_answer_print_1"}

::: answer
$\widehat{Y}$ est la projection orthogonale de $Y$ sur $[X]$ (i.e.
l'espace vectoriel engendr√© par $\mathbb{1}$ et les $X^{(k)}$).

![](/static/img/representation-variables.svg){fig-align="center"}

:::

:::


## Question 2

En d√©duire les √©galit√©s suivantes :

$$
\begin{align}
\sum\limits_{i=1}^n y_i^2 &= \sum\limits_{i=1}^n \widehat{\varepsilon}_i^2+ \sum\limits_{i=1}^n \widehat{y}_i^2 \\
\sum\limits_{i=1}^n \left(y_i-\overline{y}\right)^2 &= \sum\limits_{i=1}^n \widehat{\varepsilon}_i^2+ \sum\limits_{i=1}^n \left(\widehat{y}_i-\overline{y}\right)^2
\end{align}
$$

::: {.content-visible when-meta="is_answer_print_2"}

::: answer
D'apr√®s le th√©or√®me de Pythagore dans le triangle $0$, $Y$ et
$\widehat{Y}$,

$$
\left\| Y\right\|^2 =  \left\| \widehat{\varepsilon} \right\|^2 + \left\| \widehat{Y}  \right\|^2 
$$

c'est √† dire

$$
\sum\limits_{i=1}^n y_i^2 = \sum\limits_{i=1}^n \widehat{\varepsilon}_i^2+ \sum\limits_{i=1}^n \widehat{y}_i^2 
$$

De m√™me, en appliquant le th√©or√®me de Pythagore dans le triangle $Y$,
$\widehat{Y}$ et $\overline{y}\mathbb{1}$, on a:

$$
\left\| Y-\overline{y} \mathbb{1} \right\|^2 =  \left\| \widehat{\varepsilon} \right\|^2 + \left\| \widehat{Y} - \overline{y} \mathbb{1}\right\|^2 
$$

c'est √† dire

$$ 
\sum\limits_{i=1}^n \left(y_i-\overline{y}\right)^2 = \sum\limits_{i=1}^n \widehat{\varepsilon}_i^2+ \sum\limits_{i=1}^n \left(\widehat{y}_i-\overline{y}\right)^2 
$$

:::

:::



## Question 3

On consid√®re les ratios :

$$
R_1^2=\frac{\sum\limits_{i=1}^n \hat{y}_i^2}{\sum\limits_{i=1}^n y_i^2} \qquad
R_2^2=\frac{\sum\limits_{i=1}^n (\hat{y}_i-\overline{y})^2}{\sum\limits_{i=1}^n (y_i-\overline{y})^2}
$$

Justifier que $R_1^2 \geq R_2^2$. Dans quel cas, a-t-on √©galit√© ?

::: {.content-visible when-meta="is_answer_print_3"}

::: answer
Gr√¢ce aux relations pr√©c√©dentes, on a $$
R_1^2=1-\frac{\sum_{i=1}^n \hat{\epsilon}_i^2}{\sum_{i=1}^n y_i^2} \qquad R_2^2=1-\frac{\sum_{i=1}^n \hat{\epsilon}_i^2}{\sum_{i=1}^n\left(y_i-\bar{y}\right)^2} .
$$

Or
$$\sum\limits_{i=1}^n\left(y_i-\bar{y}\right)^2=\sum\limits_{i=1}^n y_i^2-n \bar{y}^2 \leq \sum\limits_{i=1}^n y_i^2$$
On en d√©duit que $R_1^2 \geq R_2^2$. L'√©galit√© a lieu si et seulement si
$\sum y_i^2-n \bar{y}^2=\sum y_i^2$ c'est √† dire si et seulement si
$\bar{y}=0.$

Le cas d'√©galit√© a lieu si et seulement si la variable $Y$ est centr√©e.

:::

:::

## Question 4

Quelle est la d√©finition du coefficient de corr√©lation multiple pour le
mod√®le $(*)$ ?

::: {.content-visible when-meta="is_answer_print_4"}

::: answer

Dans le mod√®le $(*)$ une constante est pr√©sente et par d√©finition
$R^2=R_2^2$.
:::

:::

## Question 5

On consid√®re √† pr√©sent un mod√®le de r√©gression sans constante, c‚Äôest √†
dire que l‚Äôon fixe $\beta_0 = 0$ dans $(*)$. Les √©galit√©s montr√©es dans
la question 2 restent-elles valables ? Quelle est dans ce cas la
d√©finition du coefficient de corr√©lation multiple ?

::: {.content-visible when-meta="is_answer_print_5"}

::: answer
Si l'on fixe $\beta_0=0$, $\mathbb{1}$ n'appartient plus √† $[X]$ et donc
$\hat{\epsilon}=Y-\hat{Y}$ n'est plus orthogonal √†
$\hat{Y}-\bar{y}\mathbb{1}$. Par contrapos√©e de la r√©ciproque du
th√©or√®me de Pythagore, la relation $(b)$ n'est plus v√©rifi√©e.

Dans ce cas, on d√©finit $R^2 = R_1^2$.
:::

:::

## Question 6

Apr√®s estimation du mod√®le $(*)$ avec ou sans la constante, on obtient
$R^2 = 0.72$ avec la constante et $R^2 = 0.96$ sans la constante.
L‚Äôintroduction de la constante est-elle pertinente ?

::: {.content-visible when-meta="is_answer_print_6"}

::: answer
Il est incoh√©rent de comparer le $R^2$ d‚Äôun mod√®le avec constante √†
celui d‚Äôun mod√®le sans constante, car les formules utilis√©es pour les
calculer diff√®rent. En particulier, comme nous l'avons d√©montr√© √† la
question 3, on a toujours $R_1^2 \geq R_2^2$. Ainsi, par construction,
le $R^2$ d‚Äôun mod√®le sans constante tend √† √™tre bien plus √©lev√© que
celui d‚Äôun mod√®le avec constante, sans que cela indique pour autant une
meilleure qualit√© du mod√®le sans constante.

:::

:::
